/**
 * @summary     KeepConditions
 * @description Store the status of the DataTable within the URL, making
 *              sharing the exact page/length/etc via copy/paste possible
 * @version     1.0.0
 * @file        dataTables.keepConditions.js
 * @author      Justin Hyland (http://www.justinhyland.com)
 * @contact     j@linux.com
 * @copyright   Copyright 2015 Justin Hyland
 * @url         https://github.com/jhyland87/DataTables-Keep-Conditions
 *
 * License      MIT - http://datatables.net/license/mit
 *
 * Store the DataTable conditions within the URL hash every time a condition is changed,
 * such as the page, length, search or a column order, making it possible to copy/paste
 * the URL. Once said URL is loaded, the conditions will be retrieved from the URL hash
 * and implemented to the table on dt.init
 */
(function(c,a,d){function e(){var k={};var g=c.location.hash.substring(1);var h=g.split("&");for(var f=0;f<h.length;f++){var j=h[f].split("=");if(typeof k[j[0]]==="undefined"){k[j[0]]=j[1]}else{if(typeof k[j[0]]==="string"){k[j[0]]=[k[j[0]],j[1]]}else{k[j[0]].push(j[1])}}}return k||false}function b(i){var g=i.data.api,f=i.data.options;var h=[];if(f.keepConditions===true||f.keepConditions.order===true&&g.order()[0]&&JSON.stringify(g.order())!==JSON.stringify(d.fn.dataTable.defaults.aaSorting)){h.push("order="+g.order()[0][0]+":"+g.order()[0][1])}if(f.keepConditions===true||f.keepConditions.search===true&&g.search()){h.push("search="+g.search())}if(f.keepConditions===true||f.keepConditions.page===true&&g.page.info()&&g.page.info().page!==0){h.push("page="+g.page.info().page)}if(f.keepConditions===true||f.keepConditions.length===true&&g.page.len()&&g.page.len()!==(f.pageLength||10)){h.push("length="+g.page.len())}c.location.hash=h.join("&")}d(a).on("init.dt",function(l,k){if(l.namespace!=="dt"){return}var h=k.oInit.keepConditions;if(d.isPlainObject(h)||h===true){var g=d.isPlainObject(h)?h:{},i=new d.fn.dataTable.Api(k),j=e(),f={api:i,options:k.oInit};if(h===true||h.order===true){i.on("order.dt",f,b);if(j.order){i.order(j.order.split(":"))}}if(h===true||h.search===true){i.on("search.dt",f,b);if(j.search){i.search(j.search)}}if(h===true||h.length===true){i.on("length.dt",f,b);if(j.length){i.page.len(parseInt(j.length))}}if(h===true||h.page===true){i.on("page.dt",f,b);if(j.page&&parseInt(j.page)!==0){i.page(parseInt(j.page))}}i.draw(false)}});d.fn.dataTable.ext.buttons.copyConditions={text:"Copy Conditions",action:function(j,i,h,f){d("<input />").val(a.location.href).attr("id","copyConditions-text").css({position:"absolute",left:"-9999px",top:(c.pageYOffset||a.documentElement.scrollTop)+"px"}).appendTo("body");d("input#copyConditions-text").select();var k=undefined;try{a.execCommand("copy");i.buttons.info("URL Copied","The URL with the DataTables conditions has been copied to your clipboard",4000);k=true}catch(g){throw new Error("Didnt work :(")}finally{d("input#copyConditions-text").remove();if(typeof k==="undefined"){i.buttons.info("URL Copied",d("<input />").val(a.location.href).css({width:"90%"}),6000)}}}}})(window,document,jQuery);